<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Market Risk Monitor</title>
</head>
<body>

<h1>Market Risk Monitor</h1>

<section id="banner">
  <h2 id="state">Loading…</h2>
  <p id="summary"></p>
</section>

<section id="history">
  <p><strong>Recent history (last 12 weeks):</strong></p>

  <pre id="timeline" aria-label="Market risk state history"></pre>

  <p id="legend">
    <strong>Legend:</strong>
    ▢ Nominal &nbsp;&nbsp; ▲ Downturn &nbsp;&nbsp; ▼ Recovery
  </p>
</section>

<hr>

<section id="disclaimer">
  <strong>Disclaimer:</strong>
  This project is for informational purposes only.

It does not constitute investment advice or a recommendation to buy or sell
any security. The system is intentionally conservative and slow‑moving, and is
designed to support disciplined long‑term decision‑making rather than
short‑term market timing.
</section>

<section id="contact">
  <strong>Contact:</strong>
  <a href="mailto:you@example.com">you@example.com</a>
</section>

<script>
/* ---------- Banner ---------- */
fetch('./data/state_snapshot.json')
  .then(r => r.json())
  .then(d => {
    const stateEl = document.getElementById('state');
    const summaryEl = document.getElementById('summary');

    if (d.override) {
      stateEl.textContent = `MARKET RISK STATE: ${d.state} (MANUAL OVERRIDE)`;
      summaryEl.textContent = d.summary;
    } else {
      const severityText = d.severity ? ` (Severity ${d.severity})` : '';
      stateEl.textContent =
        `MARKET RISK STATE: ${d.state}${severityText}`;
      summaryEl.textContent = d.summary;
    }
  })
  .catch(() => {
    document.getElementById('state').textContent = 'State unavailable';
  });

/* ---------- Timeline ---------- */
fetch('./data/state_history.csv')
  .then(r => r.text())
  .then(text => {
    const lines = text.trim().split('\n');
    if (lines.length <= 1) return;

    const symbols = {
      NOMINAL: '▢',
      DOWNTURN: '▲',
      RECOVERY: '▼'
    };

    const rows = lines.slice(1).map(l => l.split(','));
    const recent = rows.slice(-12);

    const timeline = recent
      .map(r => symbols[r[1]] || '?')
      .join(' ');

    document.getElementById('timeline').textContent = timeline;
  });
</script>

</body>
</html>